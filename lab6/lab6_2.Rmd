---
title: "dplyr Superhero"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
    toc: true
    toc_float: true
    keep_md: true
---

## Learning Goals  
*At the end of this exercise, you will be able to:*    
1. Develop your dplyr superpowers so you can easily and confidently manipulate dataframes.  
2. Learn helpful new functions that are part of the `janitor` package.  

## Instructions
For the second part of lab today, we are going to spend time practicing the dplyr functions we have learned and add a few new ones. This lab doubles as your homework. Please complete the lab and push your final code to GitHub.  

## Load the libraries
```{r}
library("tidyverse")
library("janitor")
```

## Load the superhero data
These are data taken from comic books and assembled by fans. The include a good mix of categorical and continuous data.  Data taken from: https://www.kaggle.com/claudiodavi/superhero-set  

Check out the way I am loading these data. If I know there are NAs, I can take care of them at the beginning. But, we should do this very cautiously. At times it is better to keep the original columns and data intact.  
```{r}
superhero_info <- read_csv("data/heroes_information.csv", na = c("", "-99", "-")) 
superhero_powers <- read_csv("data/super_hero_powers.csv", na = c("", "-99", "-")) 
```
## THIS IS THE HOMEWORK FOR 1.30.2024 

## Data tidy
1. Some of the names used in the `superhero_info` data are problematic so you should rename them here. Before you do anything, first have a look at the names of the variables. You can use `rename()` or `clean_names()`.

```{r}
superhero_info <- clean_names(superhero_info)
```

```{r}
superhero_powers <- clean_names(superhero_powers)
```


## `tabyl`
The `janitor` package has many awesome functions that we will explore. Here is its version of `table` which not only produces counts but also percentages. Very handy! Let's use it to explore the proportion of good guys and bad guys in the `superhero_info` data.  
```{r}
tabyl(superhero_info, alignment)
```

1. Who are the publishers of the superheros? Show the proportion of superheros from each publisher. Which publisher has the highest number of superheros?  
```{r}
superhero_info %>% 
  tabyl(publisher)
```

```{r}
#tabyl(superhero_info,publisher) another method
```

**The publisher with the highest number of superheros is Marvel Comics.** 

2. Notice that we have some neutral superheros! Who are they? List their names below.  
```{r}
superhero_info %>% 
  select(name, alignment) %>%  #Shows the name and alignment columns
  filter(alignment=="neutral") #Only gives the "neutral" alignment
```
**There are 24 neutral superheros in the superhero_info dataframe.**

## `superhero_info`
3. Let's say we are only interested in the variables name, alignment, and "race". How would you isolate these variables from `superhero_info`?
```{r}
superhero_info %>% 
  select(name, alignment, race) %>% #shows the columns for name, alignment, and race
  arrange(superhero_info) #isolates the variables
```

```{r}
#select(superhero_info, name, alignment, race)
#This is another solution for getting the variables we are interested in without involving a pipe. 
```

## Not Human
4. List all of the superheros that are not human.
```{r}
superhero_info %>% 
  filter(race != "Human")
```

```{r}
#filter(superhero_info, race!="Human")
#This is another way to do the problem not involving a pipe. This looks within race column and returns the entire superhero_info table and all the "races" that are NOT human. 
```


## Good and Evil
5. Let's make two different data frames, one focused on the "good guys" and another focused on the "bad guys".


```{r}
good_guys <- superhero_info %>% 
  filter(alignment=="good") #dataframe for good guys
```

```{r}
bad_guys <- superhero_info %>% 
  filter(alignment=="bad") #dataframe for bad guys
```

```{r}
#good_guys <- filter(superhero_info, alignment=="good")
#good_guys
#This method doesn't involve pipes
```

```{r}
#bad_guys <- filter(superhero_info, alignment=="bad")
#bad_guys
#This method doesn't involve pipes
```


6. For the good guys, use the `tabyl` function to summarize their "race".
```{r}
good_guys %>% 
  tabyl(race)
```

```{r}
#tabyl(good_guys, race)
#this method doesn't involve pipes
```


7. Among the good guys, Who are the Vampires?
```{r}
good_guys %>% 
  filter(race=="Vampire")
```

```{r}
#filter(good_guys, race=="Vampire")
#This method doesn't use pipes
```

**The vampires are Angel and Blade.** 

8. Among the bad guys, who are the male humans over 200 inches in height?
```{r}
bad_guys %>% 
  filter(race=="Human") %>% 
  filter(gender =="Male") %>% 
  filter(height > 200)

```

```{r}
#filter(bad_guys, height>200, race=="Human", gender=="Male")
#This code doesn't involve pipes. 
```


9. Are there more good guys or bad guys with green hair? 
```{r}
good_guys %>% 
  filter(hair_color == "Green")
#Good guys with green hair
```

```{r}
bad_guys %>% 
  filter(hair_color == "Green")
#Bad guys with green hair
```

```{r}
#dim(filter(bad_guys, hair_color=="Green"))
#dim(filter(good_guys, hair_color=="Green"))
```
**There are more good guys (7good vs. 1bad) with Green hair.** 

10. Let's explore who the really small superheros are. In the `superhero_info` data, which have a weight less than 50? Be sure to sort your results by weight lowest to highest.  
```{r}
superhero_info %>% 
  filter(weight<50) %>% 
  arrange(weight) #sorts the weight from lowest to highest
```


11. Let's make a new variable that is the ratio of height to weight. Call this variable `height_weight_ratio`. 
```{r}
superhero_info %>% mutate(height_weight_ratio = height/weight) %>% select(name, height, weight, height_weight_ratio) %>% arrange(desc(height_weight_ratio))
```

12. Who has the highest height to weight ratio?  
**Groot has the highest height to weight ratio at a height of 701 and weight of 4.**

## `superhero_powers`
Have a quick look at the `superhero_powers` data frame.  

```{r}
glimpse(superhero_powers)
```


13. How many superheros have a combination of agility, stealth, super_strength, stamina?
```{r}
superhero_powers %>% 
  select(agility, stealth, super_strength, stamina) %>% 
  filter(agility==T) %>% 
  filter(stealth==T) %>% 
  filter(super_strength==T) %>% 
  filter(stamina==T) %>% count()
```

```{r}
#superhero_powers <- clean_names(superhero_powers)
#dim(filter(superhero_powers, agility=="TRUE", stealth=="TRUE",super_strength=="TRUE",stamina=="TRUE"))
#This method works without pipes
```

```{r}
#unique_superheros <- superhero_powers %>% 
#filter(agility=="TRUE", stealth=="TRUE",super_strength=="TRUE",stamina=="TRUE") 
#^shows "TRUE" if superhero has all of these 
#select(hero_names, agility, stealth, super_strength, stamina)
#unique_superheros
#dim(unique_superheros)
#Another way to solve the problem!
```

**There are 40 superheros that have a combination of agility, stealth, super_strength, stamina.**

## Your Favorite
14. Pick your favorite superhero and let's see their powers!  
```{r}
groot_powers <- superhero_powers %>% 
  filter(hero_names=="Groot") %>% 
  select_if(.==TRUE)
groot_powers
```

```{r}
names(groot_powers)
```

```{r}
#filter(superhero_powers, hero_names=="Groot")
#This is a way to do it without pipes
```


15. Can you find your hero in the superhero_info data? Show their info!
```{r}
superhero_info %>% 
  filter(name=="Groot")
```

```{r}
#filter(superhero_info, name=="Groot")
#This is another way to do it without pipes
```


## Push your final code to GitHub!
Please be sure that you check the `keep md` file in the knit preferences.  